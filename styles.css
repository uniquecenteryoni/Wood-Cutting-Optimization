:root{--bg:#f6f3ef;--card:#fff;--muted:#5b5b5b;--accent:#b57b6d;--primary:#6a8f6b;--head1:#f0eadf;--head2:#e6efe6;--border:#e7e2da}
/* Headings font: Rubik (EN) + Noto Sans Hebrew Variable (HE) */
@import url('https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;600;700&display=swap');
@font-face{
	font-family:'Noto Sans Hebrew Variable';
	src:url('fonts/NotoSansHebrew-VariableFont_wdth,wght.ttf') format('truetype');
	font-weight:100 900;
	font-style:normal;
	font-display:swap;
}
@font-face{
	font-family:'Josefin Sans Variable';
	src:url('fonts/JosefinSans-VariableFont_wght.ttf') format('truetype');
	font-weight:100 700;
	font-style:normal;
	font-display:swap;
}
*{box-sizing:border-box}
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;color:#1e1e1e;margin:0;padding:0;background:var(--bg); width:100%}
/* Reserve scrollbar gutter to avoid layout shift when vertical scrollbar toggles */
/* Avoid reserving scrollbar gutter which can create visible side margins, especially in RTL */
html, body{ scrollbar-gutter: auto }
/* Better mobile tap behavior */
body{-webkit-tap-highlight-color: transparent}
h1,h2,h3{font-family:'Rubik', system-ui, -apple-system, Segoe UI, Roboto, Arial}
/* Headings bold in both languages */
html[dir="rtl"] h1, html[dir="rtl"] h2, html[dir="rtl"] h3{font-family:'Noto Sans Hebrew Variable','Rubik', system-ui, -apple-system, Segoe UI, Roboto, Arial; font-weight:700}
html[dir="ltr"] h1, html[dir="ltr"] h2, html[dir="ltr"] h3{font-family:'Josefin Sans Variable','Rubik', system-ui, -apple-system, Segoe UI, Roboto, Arial; font-weight:700}
h2{font-size:28px}
h3{font-size:18px}
html[dir="rtl"] body{ text-align:right }
html[dir="rtl"] body{font-family:'Noto Sans Hebrew Variable', system-ui, -apple-system, Segoe UI, Roboto, Arial; font-weight:100}
html[dir="ltr"] body{font-family:'Josefin Sans Variable', 'Rubik', system-ui, -apple-system, Segoe UI, Roboto, Arial; font-weight:100}
/* Make English slightly larger to match Hebrew visual weight */
html[dir="ltr"] body{ font-size: 18px }
html[dir="rtl"] body{ font-size: 16px }
html[dir="ltr"] body{ text-align:left }
html[dir="rtl"] .container, html[dir="rtl"] .card{ text-align:right }
html[dir="ltr"] .container, html[dir="ltr"] .card{ text-align:left }
.topbar{display:flex;align-items:center;justify-content:center;padding:calc(10px + env(safe-area-inset-top)) 8px 10px;background:var(--head2);box-shadow:0 1px 4px rgba(0,0,0,.06);border-bottom:1px solid var(--border);position:relative;min-height:128px; width:100%; margin:0}
.site-title{margin:0 auto;text-align:center;font-size:28px;background:transparent;padding:6px 12px;border-radius:10px;display:inline-block}
.top-left{position:absolute;left:clamp(12px, 2.5vw, 24px);top:0;bottom:auto;display:flex;align-items:center;margin-top:6px; z-index:2}
.top-center{position:absolute;left:50%;top:6px;bottom:6px;transform:translateX(-50%);display:flex;align-items:center}
.site-logo{height:100%;width:auto;display:block;border:none;border-radius:0;background:transparent}
.top-actions{display:flex;gap:10px;position:absolute;top:10px;right:14px}
.top-actions .btn{min-height:40px}
.top-actions{display:flex;gap:10px;position:absolute;top:10px;right:14px}
.top-actions .btn{min-height:40px}
.main-nav{position:sticky;top:0;background:var(--card);border-bottom:1px solid var(--border);z-index:10; width:100%; margin:0}
.main-nav .nav-wrap{max-width:none;width:100%;margin:0;padding:8px 12px;display:flex;gap:8px;overflow-x:auto;-webkit-overflow-scrolling:touch; box-sizing:border-box}
.main-nav .nav-wrap::-webkit-scrollbar{display:none}
.nav-link{display:inline-block;padding:8px 12px;border-radius:999px;text-decoration:none;color:#2b2b2b;white-space:nowrap;transition:background .2s ease,color .2s ease}
.nav-link:hover{background:var(--head2)}
.nav-link.active{background:var(--primary);color:#fff}
.container{max-width:100%;width:100%;margin:0 auto;padding:0;display:grid;grid-template-columns:1fr;gap:0}
.card{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,.04);border:1px solid var(--border); max-width:100%}
/* Full-bleed page sections: only top-level cards under .container become flat bands */
.container > .card{background:var(--card);border:none;border-radius:0;box-shadow:none;padding:56px 12px}
.container > .card + .card{border-top:1px solid var(--border)}
.container > #block-req.card:hover,
.container > #block-db.card:hover,
.container > #block-res.card:hover{ background: #fdfcfb }
.card-head{display:flex;justify-content:space-between;align-items:flex-start;position:relative;gap:8px}
.card-head h2{margin:0 auto}
.card-head .req-name{position:absolute;right:0;left:auto;top:0;display:flex;align-items:flex-start}
html[dir="rtl"] .card-head .req-name{right:0;left:auto}
.card-head .req-saw{position:absolute;left:0;right:auto;top:0;display:flex;align-items:flex-start}
html[dir="rtl"] .card-head .req-saw{left:0;right:auto}
.card-head + *{margin-top:12px}
.small-controls{display:flex;gap:8px;align-items:center}
.small-controls #saw-thickness{width:64px}
/* Align project name and saw thickness controls */
.small-controls input[type="text"],
.small-controls input[type="number"],
#project-name,
#saw-thickness{
	padding:8px 10px;
	border:1px solid var(--border);
	border-radius:8px;
	font:inherit;
	height:34px;
	background:#fff;
}
.small-controls #project-name{min-width:180px; width:clamp(220px, 32vw, 320px)}
.small-controls #saw-thickness{width:28px}
#saw-thickness{width:102px; text-align:center}
.chip#saw-unit{height:34px;display:inline-flex;align-items:center;padding:0 8px}
.small-controls .inline{gap:8px}
.small-controls label.inline{gap:8px; align-items:center}
.row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
.btn{padding:8px 12px;border-radius:8px;border:1px solid var(--border);background:#fff;cursor:pointer;color:#2b2b2b;font-size:14px;line-height:1.2;transition:background .15s ease, box-shadow .15s ease, transform .05s ease}
.btn{font-weight:100}
html[dir="rtl"] .btn{font-family:'Noto Sans Hebrew Variable', system-ui, -apple-system, Segoe UI, Roboto, Arial; font-weight:100}
html[dir="ltr"] .btn{font-family:'Josefin Sans Variable','Rubik', system-ui, -apple-system, Segoe UI, Roboto, Arial; font-weight:100}
.btn:hover{background:#faf8f4;box-shadow:0 2px 6px rgba(0,0,0,.06);transform:translateY(-1px)}
.btn:active{transform:translateY(0)}
.btn.icon-btn{padding:6px 10px;line-height:1}
.btn.primary{background:var(--primary);color:white;border:none}
.btn.primary:hover{background:#5b7f5c}
.btn.pink{background:var(--accent);color:white;border:none}
.btn.pink:hover{background:#a66f62}
select.btn{font:inherit}
/* Generic select fallback to match .btn.select look */
select{background-color:#fff}
select:not(.btn){padding:8px 12px;border:1px solid var(--border);border-radius:8px;font:inherit;min-height:38px;line-height:1.25}
/* RTL: place dropdown arrow on the left side for Hebrew */
html[dir="rtl"] .btn.select{padding-right:12px; padding-left:28px; background-position:8px 50%}
/* Pistachio Save buttons */
.btn.btn-save, .btn.btn-save-new, #project-name-ok{
	background:var(--head2); /* match site title background */
	border-color:#d2e4d2;
	color:#1f3b2a;
}
.btn.btn-save:hover, .btn.btn-save-new:hover, #project-name-ok:hover{background:#d9e9d9}
/* Saved state after clicking save */
.btn.btn-save.saved, .btn.btn-save-new.saved, #project-name-ok.saved{
	background:#4caf50;
	border-color:#3e8e41;
	color:#fff;
}
.inline{display:flex;gap:6px;align-items:center}
.chip{display:inline-block;padding:0 6px;border-radius:10px;background:#eee;font-size:12px}
.hidden{display:none}
.req-row{max-width:75vw}
#requirements-list .req-row{display:flex;flex-wrap:nowrap;gap:8px;align-items:center;padding:8px 0;border-bottom:1px dashed #eee;width:100%;overflow-x:auto}
#requirements-list .req-row::-webkit-scrollbar{height:10px}
#requirements-list .req-row select, #requirements-list .req-row input{min-height:40px}
.req-row select,.req-row input{padding:10px 12px}
.req-row select,.req-row input{border:1px solid #ddd;border-radius:8px;min-width:120px;width:auto;flex:0 0 auto}
#requirements-list .req-row select,.req-row input{border:1px solid #ddd;border-radius:8px;min-width:0;width:auto;flex:0 0 auto}
/* Fixed width for requirement fields with ellipsis to avoid growing */
#requirements-list .req-row select,
#requirements-list .req-row input[type="text"],
#requirements-list .req-row input[type="number"]{
	flex:0 0 150px;
	max-width:150px;
	text-overflow:ellipsis;
	overflow:hidden;
	white-space:nowrap;
}
#requirements-list .req-row input[data-field="length"],
#requirements-list .req-row input[data-field="qty"]{flex-basis:110px;max-width:110px}
#requirements-list .req-row input[data-field="tag"]{flex-basis:140px;max-width:140px}
.req-row .btn-remove{
	background:#e57373; /* softer red */
	color:#fff;
	border:1px solid #d32f2f;
	font-weight:700;
}
.req-row .btn-duplicate{
	/* match shape/size of remove button but with site hover pastel color */
	background:var(--head2);
	color:#000;
	border:1px solid #d2e4d2;
	font-weight:700;
	font-size:18px; min-width:40px; height:40px; display:inline-flex; align-items:center; justify-content:center;
}
.req-row .btn-remove{ height:40px; display:inline-flex; align-items:center; justify-content:center }
.req-row .btn-duplicate:hover{background:#d9e9d9}
.req-row .btn-remove:hover{background:#d32f2f;border-color:#b71c1c;color:#fff}
.req-row .btn-remove:active{background:#c62828;border-color:#8e1111;color:#fff}
.req-row .btn-remove:focus{outline:none;box-shadow:0 0 0 3px rgba(211,47,47,.25)}
/* RTL: in display settings panel, place control to the left of the text */
html[dir="rtl"] #display-settings-panel label > span:first-child{ order:2 }
html[dir="rtl"] #display-settings-panel label > select,
html[dir="rtl"] #display-settings-panel label > span[id$="-switch"]{ order:1 }
@media(max-width: 900px){
	/* שמירה על שורה אחת גם במובייל עם גלילה אופקית */
	#requirements-list .req-row{display:flex;flex-wrap:nowrap}
}
.db-table{width:max-content; min-width:100%; border-collapse:collapse; table-layout:auto}
/* Tables inherit page direction; inventory uses dir attribute at runtime */
.db-table th,.db-table td{padding:8px;border:1px solid var(--border);text-align:center;font:inherit; white-space:nowrap}
.db-table thead th{font-size:16px}
.db-table tbody tr{transition:background-color .12s ease}
.db-table tbody tr:hover{background:#f5faf5}
/* New-row classification select styling */
.db-table tr.new-row td{vertical-align:middle}
.db-table .inv-classification{
	display:block;
	width:100%;
	max-width:none;
	box-sizing:border-box;
	padding:8px 12px;
	border:1px solid var(--border);
	border-radius:8px;
	font:inherit;
	min-height:38px;
	line-height:1.25;
	background:#fff;
	text-align:start;
}
.db-table tr.new-row .inv-classification{
	display:block;
	width:100%;
	max-width:none;
	box-sizing:border-box;
	padding:8px 10px;
	border:1px solid var(--border);
	border-radius:8px;
	font:inherit;
	height:34px;
	background:#fff;
	text-align:start;
}
/* Editable cells should look like inputs while adding a new row */
.db-table tr.new-row td[contenteditable], .db-table tr.editing td[contenteditable] { background:#fff; border:1px solid var(--border); border-radius:8px; padding:6px 8px; text-align:start }
.db-table tr.new-row td[contenteditable]:empty::before{ content:attr(data-ph); color:#9aa39a }
.db-table thead tr:first-child th{background:var(--head1)}
.db-table thead tr:nth-child(2) th{background:var(--head2)}
.db-area{overflow-y:auto; overflow-x:hidden; height:50vh; max-height:50vh; padding-top:6px; scrollbar-gutter: stable both-edges; -webkit-overflow-scrolling:touch; overscroll-behavior-y:contain}
.db-area #db-table-wrap:empty{display:block;min-height:0;padding:0;border:none}
.db-table thead tr:first-child th{position:sticky;top:0;z-index:2}
.db-table thead tr:nth-child(2) th{position:sticky;top:34px;z-index:1}
.actions{margin-top:12px;display:flex;gap:8px}
.actions-center{justify-content:center}
.actions-center .btn{font-size:17px;padding:10px 15px}
.db-head{margin-top:32px}
#block-req .actions.actions-center{margin-top:32px}
.footer{padding:8px;text-align:center;color:var(--muted);font-size:12px}
.footer .footer-inner{display:inline-flex; gap:8px; align-items:center}
.footer .footer-logo{width:18px; height:18px; object-fit:contain; border-radius:2px}
.file-btn input{display:none}
.file-btn{display:inline-flex;align-items:center;gap:8px}
.file-btn span{font:inherit}
.req-row .small{font-size:12px;color:var(--muted)}
.results-section{margin-top:24px}
/* Right-align results section titles and use standard table font size */
.results-section > h3{margin:0 0 8px; text-align:right; font-size:20px}
.results-section > .x-scroll{margin-top:8px}
/* Add a small gap between each item title and its diagram */
.results-section h3 + .diagram{margin-top:8px}
.spacer-row{height:8px}
.diagram{border:none;border-radius:0;padding:8px;background:#fff; touch-action:pan-x pan-y}
.diagram text{pointer-events:none;white-space:nowrap;overflow:hidden;text-overflow:ellipsis; user-select:none}
.diagram rect[data-piece="1"]{transition:filter .15s ease, opacity .15s ease}
/* Ensure waste/kerf hatch overlay doesn't block hover */
.diagram .non-interactive{pointer-events:none}
@media (hover:hover){
	.diagram rect[data-piece="1"]:hover{filter:brightness(1.08)}
}
.legend{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
.legend .item{display:flex;gap:6px;align-items:center}
.pastel{border-radius:4px;width:20px;height:14px}
/* Small lock badge styling used next to premium toggles */
.lock{display:inline-flex; align-items:center; justify-content:center; font-size:14px; line-height:1; width:18px; height:18px; border-radius:50%; background:transparent; border:1px solid #ddd}
/* Dim switches when locked via data-locked */
.switch[data-locked="1"]{opacity:.5; cursor:not-allowed}
/* Loader overlay (full-screen) */
.loader-overlay{
	position:fixed;
	inset:0;
	z-index:9999;
	display:flex;
	flex-direction:column;
	align-items:center;
	justify-content:center;
	background:rgba(255,255,255,.82);
	backdrop-filter:saturate(120%) blur(2px);
}
.lottie-box{width:640px;height:640px}
@media(max-width:700px){
	.lottie-box{width:clamp(220px, 70vw, 420px); height:clamp(220px, 70vw, 420px)}
}
.loader-text{margin-top:10px;font-size:26px;line-height:1.2;color:#2b2b2b;text-align:center;max-width:86%;font-weight:800; margin-bottom:0}
html[dir="rtl"] .loader-text{font-family:'Noto Sans Hebrew Variable', system-ui, -apple-system, Segoe UI, Roboto, Arial}
html[dir="ltr"] .loader-text{font-family:'Josefin Sans Variable', 'Rubik', system-ui, -apple-system, Segoe UI, Roboto, Arial}
.hidden{display:none}
/* Fallback spinner */
.spinner{width:64px;height:64px;border-radius:50%;border:4px solid #d8e7d8;border-top-color:#6a8f6b;animation:spin 1s linear infinite}
@media (prefers-reduced-motion: reduce){
	.spinner{animation:none}
}
@keyframes spin{to{transform:rotate(360deg)}}
/* Plans page */
.plans-toolbar{display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
.search-input{padding:8px 12px;border:1px solid var(--border);border-radius:999px;min-width:220px;width:min(360px,100%);font:inherit}
.plans-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px}
.plan-card{background:var(--card);border:1px solid var(--border);border-radius:12px;overflow:hidden;display:flex;flex-direction:column}
.plan-card .thumb{position:relative;aspect-ratio:16/9;background:linear-gradient(135deg,#b57b6d,#6a8f6b);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;overflow:hidden}
.plan-card .thumb-img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;display:block;transition:opacity .25s ease}
.plan-card .thumb-img.secondary{opacity:0}
@media (hover:hover) and (pointer:fine){
	.plan-card:hover .thumb:not(.no-hover) .thumb-img.secondary{opacity:1; transform:translateX(0)}
	.plan-card:hover .thumb:not(.no-hover) .thumb-img.primary{opacity:0; transform:translateX(0)}
}
.plan-card .body{padding:8px 10px}
.plan-card h3{margin:0 0 6px;font-size:18px}
.plan-card p{margin:0 0 8px;color:var(--muted)}
.plan-card .price{font-weight:700;margin-bottom:10px}
.plan-card .card-actions{margin-top:auto; padding:0 10px 12px; display:flex; justify-content:center}
.plan-card .card-actions .btn{font-size:16px; padding:10px 14px; min-width:54%; border-radius:12px}
/* Articles list: 2 per row, square cards, hover effect; compact read button */
#articles-grid{display:grid; grid-template-columns:repeat(2, minmax(0,1fr)); gap:12px}
@media(max-width:700px){ #articles-grid{ grid-template-columns:1fr } }
#articles-grid .plan-card{ border-radius:0; transition:box-shadow .2s ease, transform .12s ease }
#articles-grid .plan-card .thumb, #articles-grid .plan-card .thumb-img{ border-radius:0 }
#articles-grid .plan-card .thumb{ height:150px; aspect-ratio:auto }
#articles-grid .plan-card .thumb-img{ width:100%; height:100%; object-fit:cover }
@media(max-width:700px){ #articles-grid .plan-card .thumb{ height:120px } }
#articles-grid .plan-card:hover{ transform:translateY(-2px); box-shadow:0 8px 20px rgba(0,0,0,.08) }
#articles-grid .card-actions .btn{ text-decoration:none; min-width:auto; padding:6px 12px; display:inline-flex; align-items:center; justify-content:center }
#articles-grid .card-actions .btn:hover{ text-decoration:none }

/* Articles (detail page) — single column, 80% width, no hero image */
.article{ display:block; max-width:80%; margin:0 auto }
@media(max-width:900px){ .article{ max-width:92% } }
.article .article-hero{ display:none }
.article .article-body{ line-height:1.65 }
.article .article-body p{ margin:0 0 1em }
/* About */
.about-wrap{display:grid;grid-template-columns:1.2fr 1fr;grid-template-areas:"text photo";gap:16px;align-items:stretch; min-height:60vh; width:100%; max-width:none; margin:0}
.container > .card.about-wrap{padding-left:clamp(24px, 8vw, 88px); padding-right:clamp(24px, 8vw, 88px)}
.about-wrap .about-text{grid-area:text;padding-inline:0; max-width: 48ch}
.about-wrap .about-photo{grid-area:photo; display:flex}
.about-photo img{width:100%;height:100%;object-fit:cover;border-radius:12px;border:1px solid var(--border);display:block}
.about-text h2{margin-top:0}
.about-meta{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap}
@media(max-width:900px){
	.about-wrap{grid-template-columns:1fr;grid-template-areas:"photo" "text"; min-height:auto}
	.about-photo img{height:auto}
}
/* הצגה אנכית של הבלוקים גם במסכים רחבים */
@media(min-width:900px){.container{grid-template-columns:1fr}}
@media(max-width:600px){.topbar h1{font-size:16px}.btn{padding:6px 8px}.container{grid-template-columns:1fr}}

/* Calculator header (requirements block) — center controls and enlarge heading */
#block-req .card-head{flex-direction:column;align-items:stretch;gap:8px}
#block-req .card-head h2{font-size:36px; align-self:center}

#block-req .actions.actions-center{justify-content:center}
#block-req .small-controls{justify-content:flex-start;flex-wrap:wrap; align-items:flex-start}
#block-req .small-controls .inline{justify-content:flex-start}
#block-req.center-empty{display:flex; flex-direction:column; justify-content:center; min-height:360px; position:relative}
#block-req.center-empty .card-head{margin:0 auto 12px; text-align:center; align-items:flex-start; position:static}
#block-req.center-empty .card-head h2{margin:0 auto}
/* Pin controls to block edges (not the centered head) */
#block-req.center-empty .req-name{position:absolute; right:3px; left:auto}
#block-req.center-empty #saw-settings-btn{position:absolute; left:3px; right:auto}
#block-req.center-empty .actions.actions-center{justify-content:center; margin-top:36px}
@media(min-width:701px){
	#block-req.center-empty .req-name{ top:-45px }
	#block-req.center-empty #saw-settings-btn{ top:-45px }
}
#block-req.center-empty #requirements-list{display:none}
#block-req.center-empty .actions.actions-center{justify-content:center; margin-top:16px}
#block-db .card-head h2, #block-res h2{font-size:36px}
/* Normalize Block 3 title spacing and alignment */
#block-res h2{margin:0 auto}
/* Ensure results section subtitles are right-aligned and compact */
.results-section > h3{margin:0 0 8px; text-align:right}
/* Distinguish section titles (tables/maps) vs item titles (each diagram) */
.results-section > h3.section-title{font-size:20px; text-align:center}
.results-section h3.item-title{font-size:16px}
.results-section > .x-scroll{margin:10px 0 0 0;}
#results-area .results-section + .results-section{margin-top:40px}
#block-res h2 + #results-area{margin-top:16px}
#results-area{max-width:100%; overflow:visible; padding-left:clamp(12px, 2.5vw, 24px); padding-right:clamp(12px, 2.5vw, 24px)}
.container #block-res{ overflow-x:hidden }
#results-area{ overflow-x:hidden }
.no-results{margin:0 auto; text-align:center; display:block; padding:8px 12px}
/* Force small-controls to the physical left in RTL */
html[dir="rtl"] #block-req .small-controls{justify-content:flex-end}
/* Increase key button sizes by ~25% */
#add-req.btn, #calc-opt.btn, #toggle-db.btn, .btn.file-btn{font-size:17px;padding:10px 15px}
#block-req .small-controls label span{font-size:16px;font-weight:500}
/* Extra spacing under Block 1 title: match Block 2 when list is empty */
#requirements-list:empty{display:none;margin-top:0}
#block-req .actions.actions-center{margin-top:24px}
.db-head{margin-top:36px}
/* Center and space requirements list */
#requirements-list{display:flex;flex-direction:column;gap:8px;align-items:center;margin-top:16px}
#requirements-list .req-row{justify-content:center}

/* Block 1: top-right project name and bottom-left saw thickness */
.req-name{display:flex;justify-content:flex-end}
html[dir="rtl"] .req-name{justify-content:flex-start}
.req-saw{display:flex;justify-content:flex-start;margin-top:0}
html[dir="rtl"] .req-saw{justify-content:flex-end}

/* Block 2: pin status to bottom-left */
#block-db{position:relative;padding-bottom:64px}
#block-db .card-head{justify-content:center}
#block-db .db-head{display:flex;flex-direction:column;align-items:center;gap:8px;width:100%}
#block-db .db-right{display:flex;align-items:center;gap:8px;justify-content:center}
#block-db .db-add-wrap{display:flex;justify-content:center; gap:8px}
#block-db .db-add-wrap .btn{height:40px}
#block-db .db-status{position:absolute;left:16px;bottom:16px;min-height:18px;color:#2e7d32;margin:0;text-align:left}
#block-db .db-status:empty{display:none}
html[dir="rtl"] #block-db .db-status{left:16px;right:auto;text-align:left}
/* Ensure spacing below DB title to its button row */
#block-db .db-head{margin-top:24px}

/* Block 3: make export PDF button larger and add extra spacing */
#block-res .actions.actions-center{margin-top:18px}
#export-pdf.btn{font-size:17px;padding:10px 15px;margin-top:8px}

/* Results error modal (inline within Block 3) */
#block-res .res-modal{position:relative;margin:12px auto 0;max-width:960px}
#block-res .res-modal-backdrop{position:absolute;inset:0;background:rgba(0,0,0,.12);border-radius:12px}
#block-res .res-modal-box{position:relative;margin:0 auto;max-width:720px;background:#fff8f8;border:1px solid var(--border);border-left:4px solid #d32f2f;border-radius:12px;padding:12px;box-shadow:0 6px 24px rgba(0,0,0,.12)}
#block-res .res-modal-title{margin:0 0 6px;color:#b71c1c}
#block-res .res-modal-body{color:#8a1f1f}
#block-res .res-modal-actions{display:flex;justify-content:center;margin-top:10px}

/* אזורי גלילה אופקית מבודדים (טבלאות/דיאגרמות בתוצאות) */
.x-scroll{overflow-x:auto; max-width:100%; -webkit-overflow-scrolling:touch; overscroll-behavior-x:contain; scrollbar-gutter: stable both-edges; scroll-behavior:auto; direction:ltr}
.x-scroll{overflow-anchor: none}

/* Add wood button pastel red style */
.btn.add-wood{background:#ffe5e5;border-color:#f5c2c2;color:#000; text-align:center; font-size:17px}
.btn.add-wood:hover{background:#ffd9d9}
.btn.add-wood:active{transform:scale(.98)}

/* Saw icon button styling (desktop + mobile) */
#saw-settings-btn{display:inline-flex; align-items:center; justify-content:center; width:40px; height:40px; padding:0}
#saw-settings-btn img{width:24px; height:24px}

/* Make hamburger bars horizontal */
.hamburger .bars{flex-direction:column}
.hamburger .bar{width:24px; height:3px}

/* Initial compact view (first load): ensure blocks up to the Summarize button fit without scrolling */
body.initial-compact{overflow-y:auto}
body.initial-compact .topbar{min-height:96px;padding:6px 12px}
body.initial-compact .main-nav .nav-wrap{padding:6px 10px}
body.initial-compact .container > .card{padding:24px 12px}
body.initial-compact .card-head + *{margin-top:8px}
body.initial-compact #block-req .actions.actions-center{margin-top:16px}
body.initial-compact .db-head{margin-top:12px}
body.initial-compact #requirements-list{margin-top:8px}
body.initial-compact #block-db{padding-bottom:16px}
body.initial-compact #block-db .db-status{display:none}
body.initial-compact #results-area p{display:none}
body.initial-compact #block-res .actions.actions-center{margin-top:8px}
body.initial-compact .footer{display:none}

/* Ultra-tight fallback if viewport is extremely short */
body.initial-compact-tight .topbar{min-height:72px;padding:4px 10px}
body.initial-compact-tight .main-nav .nav-wrap{padding:4px 8px}
body.initial-compact-tight .container > .card{padding:16px 10px}
body.initial-compact-tight .card-head + *{margin-top:6px}
body.initial-compact-tight #block-req .actions.actions-center{margin-top:10px}
body.initial-compact-tight .db-head{margin-top:8px}
body.initial-compact-tight #requirements-list{margin-top:6px}
body.initial-compact-tight #block-res .actions.actions-center{margin-top:6px}
body.initial-compact-tight h2{font-size:28px}

/* Forms */
.form-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
.form-field{display:flex;flex-direction:column;gap:6px}
.form-field-full{grid-column:1/-1}
.pay-form form{padding:12px 14px}
.checkout-grid .card .card-head h2{margin-top:12px}
.form-field label{font-size:14px;color:#333}
.form-field input,.form-field textarea{padding:10px 12px;border:1px solid var(--border);border-radius:8px;font:inherit;background:#fff}
.form-field input,.form-field textarea{ background: #faf6f2 }
.form-field input:focus,.form-field textarea:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px rgba(106,143,107,.15)}
.form-actions{display:flex;gap:8px;justify-content:flex-start}
.form-actions .btn{font-weight:100}
.form-status{margin-top:8px;color:var(--muted)}
@media(max-width:700px){.form-grid{grid-template-columns:1fr}}

/* Mobile enhancements: safer text scaling, fluid diagrams, table scroll, and narrow stacking */
html{-webkit-text-size-adjust:100%;text-size-adjust:100%}
.no-x-scroll, html, body{max-width:100vw; width:100%; overflow-x:hidden}

/* Saw popover panel (dynamic content) */
.saw-popover{position:fixed;left:14px;top:50%;transform:translateY(-50%);background:#fff;border:1px solid var(--border);border-radius:10px;padding:14px;box-shadow:0 8px 28px rgba(0,0,0,.16);min-width:320px;z-index:1100;text-align:left}
.saw-popover .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.saw-popover .switch{width:44px;height:24px;border-radius:12px;background:#c7c7c7;position:relative;cursor:pointer}
.saw-popover .switch[data-on="1"]{background:#4caf50}
.saw-popover .switch .knob{position:absolute;top:2px;left:2px;width:20px;height:20px;border-radius:50%;background:#fff;box-shadow:0 1px 3px rgba(0,0,0,.25);transition:left .2s}
.saw-popover .switch[data-on="1"] .knob{left:22px}
.saw-popover .trim-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:6px}
.saw-popover .trim-grid input{min-height:34px;padding:8px 10px;border:1px solid var(--border);border-radius:8px;width:100%}
.saw-popover input[type="number"], .saw-popover input[type="text"]{min-height:34px;padding:8px 10px;border:1px solid var(--border);border-radius:8px;width:100%;box-sizing:border-box}
@supports (padding: max(0px)){
	body{ width:100vw; }
}
.x-scroll{overflow-x:auto; max-width:100%; -webkit-overflow-scrolling:touch; overscroll-behavior-x:contain; /* Allow both directions so vertical scroll always works */ touch-action:pan-x pan-y}
.diagram svg{max-width:100%;height:auto;display:block}
@media(max-width:640px){
	.db-area{-webkit-overflow-scrolling:touch}
	#db-table-wrap{overflow-x:auto}
}
/* Ensure DB table can scroll horizontally without affecting the page */
#db-table-wrap{overflow-x:auto; max-width:100%; -webkit-overflow-scrolling:touch; overscroll-behavior-x:contain; touch-action:pan-x pan-y; scrollbar-gutter: stable}
#db-table-wrap{overflow-anchor: none}

/* Make main blocks edge-to-edge on mobile (no side gutters under the header) */
@media(max-width:900px){
	.container{ padding-left:0; padding-right:0 }
	.container > .card{ padding-left:0; padding-right:0 }
}
/* Keep DB area from creating horizontal page scroll; only inner #db-table-wrap may scroll X */
.db-area{overflow-y:auto; overflow-x:hidden}
/* Guard the whole DB block from leaking horizontal overflow */
#block-db{overflow-x:hidden}
@media(max-width:520px){
	#requirements-list .req-row{grid-template-columns:1fr}
	#requirements-list .req-row > *{grid-column:1/-1 !important; justify-self:stretch}
}

/* ===== Mobile side drawer navigation ===== */
/* Hide the horizontal nav on mobile, show a floating hamburger on the side */
@media(max-width:900px){
	.main-nav{display:none}
	.hamburger{
		position:fixed; z-index:1100; top:calc(96px + env(safe-area-inset-top)); transform:none;
		width:56px; height:56px; border-radius:50%; border:1px solid var(--border);
		background:#fff; box-shadow:0 4px 20px rgba(0,0,0,.12);
		display:flex; align-items:center; justify-content:center; cursor:pointer;
	}
	html[dir="rtl"] .hamburger{ right:10px }
	html[dir="ltr"] .hamburger{ left:10px }
	.hamburger .bars{display:flex; gap:6px; flex-direction:column}
	.hamburger .bar{width:24px; height:3px; background:#2b2b2b; border-radius:3px}
	.hamburger:active{transform:scale(.96)}

	.drawer-backdrop{position:fixed; inset:0; background:rgba(0,0,0,.28); z-index:1099; display:none}
	.drawer-backdrop.open{display:block}
	.mobile-drawer{
		position:fixed; top:0; bottom:0; width:min(76vw, 320px);
		background:#fff; border-left:1px solid var(--border); border-right:1px solid var(--border);
		box-shadow:0 8px 28px rgba(0,0,0,.16); z-index:1101; padding:16px; overflow:auto;
		transition:transform .22s ease;
	}
	html[dir="rtl"] .mobile-drawer{ right:0; transform:translateX(100%) }
	html[dir="ltr"] .mobile-drawer{ left:0;  transform:translateX(-100%) }
	.mobile-drawer.open{ transform:translateX(0) }
	.mobile-drawer .nav-link{display:block; padding:12px 10px; border-radius:10px; margin-bottom:6px}
}

/* Mobile tap slider for plan thumbnails + dots */
.plan-card .thumb{position:relative; overflow:hidden}
.plan-card .thumb .dots{position:absolute;left:50%;bottom:6px;transform:translateX(-50%);display:flex;gap:6px;align-items:center;justify-content:center}
.plan-card .thumb .dot{width:8px;height:8px;border-radius:50%;border:2px solid rgba(255,255,255,.9);background:transparent}
.plan-card .thumb .dot.active{background:#fff}
/* Ensure 3-step carousel frames overlay each other */
.plan-card .thumb .step{position:absolute; inset:0; transition:opacity .25s ease}
/* Carousel arrows */
.plan-card .thumb .arrow{
	position:absolute; top:50%; transform:translateY(-50%);
	width:34px; height:34px; border-radius:50%; border:1px solid rgba(255,255,255,.65);
	background:rgba(0,0,0,.25); color:#fff; display:flex; align-items:center; justify-content:center;
	cursor:pointer; user-select:none; backdrop-filter:saturate(120%) blur(1px);
}
.plan-card .thumb .arrow.left{ left:8px }
.plan-card .thumb .arrow.right{ right:8px }
.plan-card .thumb .arrow:active{ transform:translateY(-50%) scale(.96) }

/* Desktop: final placement override for Block 1 header controls (wins over earlier top:0 rules) */
@media(min-width:701px){
	#block-req .card-head .req-name{ top:-45px; right:3px; }
	#block-req #saw-settings-btn{ top:-45px; }
}

/* Final header cleanup: keep only name field and saw icon visible in Block 1 */
#block-req #project-name-ok{ display:none !important }

/* RTL: make the first dot appear on the right */
html[dir="rtl"] .plan-card .thumb .dots{flex-direction:row-reverse}
/* Slide transition between images on tap */
.plan-card .thumb-img{transition:transform .28s ease, opacity .28s ease}
.plan-card .thumb-img.primary{transform:translateX(0);opacity:1}
.plan-card .thumb-img.secondary{transform:translateX(100%);opacity:0}
.plan-card .thumb.show-secondary .thumb-img.primary{transform:translateX(-100%);opacity:0}
.plan-card .thumb.show-secondary .thumb-img.secondary{transform:translateX(0);opacity:1}

/* Global centered modal for errors and alerts */
.global-modal{position:fixed; inset:0; z-index:1300; display:flex; align-items:center; justify-content:center}
.global-modal-backdrop{position:absolute; inset:0; background:transparent; backdrop-filter:none; pointer-events:none}
.global-modal-box{position:relative; z-index:1; width:min(92vw, 560px); background:#fff; border:1px solid var(--border); border-radius:14px; box-shadow:0 10px 36px rgba(0,0,0,.22); padding:16px}
.global-modal-title{margin:0 0 8px}
.global-modal-body{color:#8a1f1f; background:#fff8f8; border:1px solid #f2c6c6; border-left:4px solid #d32f2f; border-radius:10px; padding:10px}
.global-modal-actions{display:flex; justify-content:center; gap:8px; margin-top:12px}

/* Desktop: pin saw icon and project name under the top separator, keep title at standard offset */
@media(min-width:701px){
	#block-req .card-head{align-items:flex-start}
	/* Card has 56px top padding; place controls near the top border */
	.card-head .req-name{top:-56px}
	#saw-settings-btn{top:-56px}
	/* Hide the save button for project name on desktop */
	.card-head .req-name #project-name-ok{display:none !important}
}

/* DB buttons sizing: make top row button span width of bottom controls */
#block-db .db-right{width:100%; justify-content:center}
#block-db .db-right #add-db-row{width:100%}

/* Overrides: align Block 1 controls to top and use saw icon globally */
.card-head{align-items:flex-start}
.card-head .req-saw{display:none !important}
#block-req .card-head{align-items:stretch}
#block-req .card-head h2{align-self:center}
#saw-settings-btn{position:absolute; top:0; left:clamp(12px, 2.5vw, 24px)}
html[dir="rtl"] #saw-settings-btn{right:auto; left:clamp(12px, 2.5vw, 24px)}
html[dir="ltr"] #saw-settings-btn{left:clamp(12px, 2.5vw, 24px)}
.card-head .req-name{position:absolute; top:0; right:3px}

/* Desktop: place Block 1 header controls right under the nav separator */
@media(min-width:701px){
	.container > #block-req.card{padding-top:56px}
}

/* Desktop: equalize initial block heights before content expands */
@media(min-width:701px){
	.container > #block-req.card,
	.container > #block-db.card,
	.container > #block-res.card{ min-height: 320px }
}

/* Kerf (saw) modal clean design */
.kerf-modal .global-modal-body{border:none; background:transparent; padding:0}
.kerf-modal .kerf-row{display:flex; align-items:center; gap:10px; justify-content:center; margin-top:8px}
.kerf-modal .kerf-row input{padding:10px 12px; border:1px solid var(--border); border-radius:10px; font:inherit; width:140px; text-align:center; background:#fff; height:40px}
.kerf-modal .kerf-row .chip{height:40px; display:inline-flex; align-items:center; padding:0 12px; border:1px solid var(--border); border-radius:10px; background:#fff; font:inherit}
.kerf-modal .global-modal-actions .btn{min-width:96px}

/* Ensure DB buttons are vertically and horizontally centered */
#block-db .db-head .btn{display:inline-flex; align-items:center; justify-content:center}

/* Ensure DB action buttons have uniform height */
#block-db .db-head .btn{height:40px; display:inline-flex; align-items:center}

/* Hamburger bars horizontal */
.hamburger .bars{flex-direction:column}
.hamburger .bar{width:24px; height:3px}

/* ===== Mobile Block 1 layout tweaks ===== */
@media(max-width:700px){
	/* Show project name at the very top of Block 1 header */
	#block-req .card-head{position:static; align-items:center; gap:8px}
	#block-req .card-head .req-name{display:none !important}
	#block-req .card-head h2{order:1; margin: 0}
	/* Hide original saw row on mobile */
		#block-req .card-head .req-saw{display:none !important}
		#block-req{display:flex; flex-direction:column; position:relative}
	/* Mobile saw settings trigger */
		#saw-settings-btn{display:inline-flex !important; position:absolute; top:3px; right:auto; font-size:20px; width:40px; height:40px; align-items:center; justify-content:center}
			html[dir="rtl"] #saw-settings-btn{left:clamp(12px, 2.5vw, 24px)}
			html[dir="ltr"] #saw-settings-btn{left:clamp(12px, 2.5vw, 24px)}
		.saw-popover{position:absolute; top:48px; left:0; right:auto; background:#fff; border:1px solid var(--border); border-radius:10px; padding:10px; box-shadow:0 8px 28px rgba(0,0,0,.16); z-index:20}
	/* Spacing when project name sits below the buttons */
		#block-req .req-name.is-mobile-below{display:none !important}
}

/* Results: give a bit more breathing room before the cutting map heading */
#block-res .results-section h3{margin-top:8px}
#block-res .results-section:last-of-type h3{margin-top:16px}

/* Plate diagrams: ensure left gutter for vertical ruler/labels roughly matches the top gutter */
svg.diagram[data-kind="plate"]{margin-left:12px}

/* Block 3 (Display settings) — tighter spacing and compact controls */
#display-settings{ margin:6px 0 !important; padding-left:clamp(12px, 2.5vw, 24px); padding-right:clamp(12px, 2.5vw, 24px) }
#display-settings-panel{ gap:10px !important; padding:8px 10px !important }
#display-settings-panel label{ gap:8px !important }
#display-settings-panel select.btn{
	padding:4px 10px;
	height:auto;
	min-height:34px;
	line-height:1.2;
	text-align-last:center; /* center selected text */
	-moz-text-align-last:center; /* firefox */
	white-space:nowrap;
}
